{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/alert.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,6JACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG3B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE,oBACnC,8OAAC;QACC,KAAK;QACL,MAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG;AAEpB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oKAAA,CAAA,OAAsB;QACrB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,oKAAA,CAAA,YAA2B;YAC1B,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE;sBAEd,cAAA,8OAAC,oMAAA,CAAA,QAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,oKAAA,CAAA,OAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,iKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root> & { indicatorClassName?: string }\n>(({ className, value, indicatorClassName, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className={cn(\"h-full w-full flex-1 bg-primary transition-all\", indicatorClassName)}\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n"],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,kBAAkB,EAAE,GAAG,OAAO,EAAE,oBACrD,8OAAC,oKAAA,CAAA,OAAsB;QACrB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,iEACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,oKAAA,CAAA,YAA2B;YAC1B,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,kDAAkD;YAChE,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIhE,SAAS,WAAW,GAAG,oKAAA,CAAA,OAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 268, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/ai-imaging-diagnosis-flow.ts"],"sourcesContent":["'use server';\n/**\n * @fileOverview An AI flow for analyzing medical imaging scans.\n *\n * - diagnoseImage - A function that handles the image analysis.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {z} from 'genkit';\nimport type { ImagingDiagnosisInput, ImagingDiagnosisOutput } from '@/lib/types';\n\nconst ImagingDiagnosisInputSchema = z.object({\n  image: z\n    .string()\n    .describe(\n      \"A medical image (e.g., X-ray, CT scan) as a data URI. Expected format: 'data:<mimetype>;base64,<encoded_data>'.\"\n    ),\n});\n\nconst ImagingDiagnosisOutputSchema = z.object({\n    potentialConditions: z.array(z.object({\n        condition: z.string().describe('The name of the potential condition detected (e.g., \"Pneumonia\", \"Metastatic bone tumor\").'),\n        confidence: z.number().describe('The AI\\'s confidence in this finding, from 0 to 100.'),\n    })).describe('A list of potential conditions identified in the image.'),\n    summary: z.string().describe('A high-level summary of the overall findings, written in clear, accessible language.'),\n    observations: z.string().describe('A more detailed, point-by-point breakdown of what the AI observed in the image (e.g., \"Observed an opacity in the lower left lung lobe.\").'),\n    disclaimer: z.string().describe('A mandatory warning that this analysis is not a substitute for a professional diagnosis.'),\n    heatmapDataUri: z.string().optional().describe('A data URI of the generated heatmap visualization.'),\n});\n\nconst textAnalysisPrompt = ai.definePrompt({\n    name: 'imagingDiagnosisTextPrompt',\n    input: {schema: ImagingDiagnosisInputSchema},\n    output: {schema: ImagingDiagnosisOutputSchema},\n    prompt: `You are an expert AI radiology assistant. Your task is to analyze a medical image and provide a preliminary diagnostic report for informational purposes.\n\nImage to Analyze: {{media url=image}}\n\nAnalyze the image for any abnormalities or significant findings.\n1.  Identify a list of 'potentialConditions'. For each condition, provide your 'confidence' score as a percentage (0-100).\n2.  Write a concise 'summary' of your findings in simple terms.\n3.  Provide a bulleted list of detailed 'observations'.\n4.  You MUST include the following 'disclaimer': \"This AI-generated analysis is for informational purposes only and is NOT a substitute for a professional diagnosis from a qualified radiologist or physician. Please consult with your healthcare provider to review these findings.\"\n\nIf the image does not appear to be a medical scan or is unclear, state that in the summary and observations.\n`,\n});\n\nconst generateHeatmapFlow = ai.defineFlow(\n    {\n        name: 'generateHeatmapFlow',\n        inputSchema: ImagingDiagnosisInputSchema,\n        outputSchema: z.string(),\n    },\n    async (flowInput) => {\n        const {media} = await ai.generate({\n            model: 'googleai/gemini-2.5-flash-image-preview',\n            prompt: [\n                {media: {url: flowInput.image}},\n                {text: 'Based on the provided medical image (like an X-ray or CT scan), generate a simulated Grad-CAM heatmap. The heatmap should be a plausible visualization of where an AI might focus its attention to make a diagnosis. Overlay this heatmap onto the original image. The heatmap should use a color scale from yellow (low attention) to red (high attention) and be semi-transparent.'},\n            ],\n            config: {\n                responseModalities: ['TEXT', 'IMAGE'],\n            },\n        });\n        return media!.url;\n    }\n);\n\n\nconst diagnoseImageFlow = ai.defineFlow(\n    {\n        name: 'diagnoseImageFlow',\n        inputSchema: ImagingDiagnosisInputSchema,\n        outputSchema: ImagingDiagnosisOutputSchema,\n    },\n    async (flowInput) => {\n        // Run text analysis and heatmap generation in parallel\n        const [textAnalysisResult, heatmapResult] = await Promise.all([\n            textAnalysisPrompt(flowInput),\n            generateHeatmapFlow(flowInput)\n        ]);\n        \n        const { output } = textAnalysisResult;\n        \n        if (!output) {\n            throw new Error('Text analysis failed to produce an output.');\n        }\n\n        return {\n            ...output,\n            heatmapDataUri: heatmapResult,\n        };\n    }\n);\n\nexport async function diagnoseImage(input: ImagingDiagnosisInput): Promise<ImagingDiagnosisOutput> {\n    return diagnoseImageFlow(input);\n}\n"],"names":[],"mappings":";;;;;;IAgGsB,gBAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 281, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28app%29/imaging-diagnosis/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport Image from 'next/image';\nimport { Bot, Loader2, UploadCloud, ScanSearch, AlertTriangle, Trash2, Download } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from '@/components/ui/card';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { Progress } from '@/components/ui/progress';\nimport { cn } from '@/lib/utils';\nimport { diagnoseImage } from '@/ai/flows/ai-imaging-diagnosis-flow';\nimport type { ImagingDiagnosisOutput } from '@/lib/types';\nimport { useToast } from '@/hooks/use-toast';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\n\nexport default function ImagingDiagnosisPage() {\n  const [image, setImage] = useState<string | null>(null);\n  const [analysis, setAnalysis] = useState<ImagingDiagnosisOutput | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [hasConsented, setHasConsented] = useState(false);\n  const { toast } = useToast();\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    const file = acceptedFiles[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        setImage(e.target?.result as string);\n        setAnalysis(null);\n        setError(null);\n      };\n      reader.readAsDataURL(file);\n    }\n  }, []);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: { 'image/jpeg': [], 'image/png': [], 'image/dicom': [] },\n    multiple: false,\n  });\n\n  const handleAnalyze = async () => {\n    if (!image) return;\n    setIsLoading(true);\n    setError(null);\n    setAnalysis(null);\n\n    try {\n      const result = await diagnoseImage({ image });\n      setAnalysis(result);\n    } catch (err) {\n      console.error(err);\n      setError('An error occurred during analysis. The image might be unsupported or of poor quality. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n   const handleDownloadReport = () => {\n        const reportElement = document.getElementById('ai-report-card');\n        if (!reportElement || !analysis) {\n            toast({\n                title: \"Error\",\n                description: \"Cannot download report right now. Please try again.\",\n                variant: \"destructive\"\n            });\n            return;\n        }\n\n        toast({\n            title: \"Generating PDF...\",\n            description: \"Your report is being prepared for download.\",\n        });\n\n        html2canvas(reportElement, { scale: 2 }).then((canvas) => {\n            const imgData = canvas.toDataURL('image/png');\n            const pdf = new jsPDF('p', 'px', 'a4');\n            const pdfWidth = pdf.internal.pageSize.getWidth();\n            const pdfHeight = pdf.internal.pageSize.getHeight();\n            const canvasWidth = canvas.width;\n            const canvasHeight = canvas.height;\n            const ratio = canvasWidth / canvasHeight;\n            const width = pdfWidth;\n            const height = width / ratio;\n\n            let position = 0;\n            if (height < pdfHeight) {\n                position = (pdfHeight - height) / 2;\n            }\n            \n            pdf.addImage(imgData, 'PNG', 0, position, width, height);\n            pdf.save(`HealthFlow_Imaging_Report_${new Date().toISOString().split('T')[0]}.pdf`);\n        });\n    };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\n          <ScanSearch /> AI Imaging &amp; Diagnosis\n        </h1>\n        <p className=\"text-muted-foreground\">\n          Upload a medical image for a preliminary, AI-powered diagnostic analysis.\n        </p>\n      </div>\n\n      <Alert variant=\"destructive\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertTitle>For Informational Use Only</AlertTitle>\n        <AlertDescription>\n          This AI analysis is not a medical diagnosis. Always consult a qualified healthcare professional for any health concerns and to interpret your medical images.\n        </AlertDescription>\n      </Alert>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Upload Medical Image</CardTitle>\n          <CardDescription>Upload an X-ray, CT scan, or MRI image (JPG, PNG). DICOM support is experimental.</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {!image ? (\n            <div\n              {...getRootProps()}\n              className={cn(\n                'flex flex-col items-center justify-center p-12 border-2 border-dashed rounded-lg cursor-pointer transition-colors',\n                isDragActive ? 'border-primary bg-primary/10' : 'border-border hover:border-primary/50'\n              )}\n            >\n              <input {...getInputProps()} />\n              <UploadCloud className=\"h-12 w-12 text-muted-foreground\" />\n              <p className=\"mt-4 text-center text-muted-foreground\">\n                {isDragActive ? 'Drop the image here...' : \"Drag 'n' drop an image, or click to select\"}\n              </p>\n            </div>\n          ) : (\n            <div className=\"relative w-full max-w-md mx-auto bg-black rounded-md p-2\">\n                <Image src={image} alt=\"Medical image preview\" width={512} height={512} className=\"rounded-md object-contain aspect-square mx-auto\" />\n                <Button variant=\"destructive\" size=\"icon\" className=\"absolute top-2 right-2 z-10\" onClick={() => setImage(null)}>\n                    <Trash2 className=\"h-4 w-4\" />\n                </Button>\n            </div>\n          )}\n          \n          <div className=\"flex items-center space-x-2\">\n            <Checkbox id=\"consent\" checked={hasConsented} onCheckedChange={(checked) => setHasConsented(!!checked)} />\n            <Label htmlFor=\"consent\" className=\"text-sm text-muted-foreground\">\n              I consent to have this image analyzed by the AI for informational purposes.\n            </Label>\n          </div>\n\n          <Button onClick={handleAnalyze} disabled={isLoading || !image || !hasConsented}>\n            {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n            {isLoading ? 'Analyzing...' : 'Run AI Analysis'}\n          </Button>\n        </CardContent>\n      </Card>\n\n      {error && (\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertTitle>Analysis Failed</AlertTitle>\n          <AlertDescription>{error}</AlertDescription>\n        </Alert>\n      )}\n\n      {(isLoading || analysis) && (\n        <Card id=\"ai-report-card\">\n          <CardHeader>\n            <CardTitle>AI Diagnostic Report</CardTitle>\n            <CardDescription>This is a preliminary analysis. Please review with your doctor.</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {!analysis ? (\n                <div className=\"space-y-6\">\n                    <Skeleton className=\"h-8 w-3/4\" />\n                    <Skeleton className=\"h-4 w-full\" />\n                    <Skeleton className=\"h-4 w-5/6\" />\n                    <div className=\"space-y-4 pt-4\">\n                        <Skeleton className=\"h-8 w-1/2\" />\n                        <Skeleton className=\"h-10 w-full\" />\n                        <Skeleton className=\"h-10 w-full\" />\n                    </div>\n                </div>\n            ) : (\n                <>\n                    <div>\n                        <h3 className=\"font-semibold text-lg mb-2\">Overall Summary</h3>\n                        <p className=\"text-sm text-muted-foreground\">{analysis.summary}</p>\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <h3 className=\"font-semibold text-lg\">Potential Conditions</h3>\n                        {analysis.potentialConditions.length > 0 ? analysis.potentialConditions.map((item, index) => (\n                            <div key={index} className=\"space-y-2\">\n                                <div className=\"flex justify-between items-center\">\n                                    <p className=\"font-medium\">{item.condition}</p>\n                                    <span className=\"font-bold text-primary\">{item.confidence}% Confidence</span>\n                                </div>\n                                <Progress value={item.confidence} className=\"h-2\" />\n                            </div>\n                        )) : <p className=\"text-sm text-muted-foreground\">No specific conditions identified with high confidence.</p>}\n                    </div>\n                    \n                    <div>\n                        <h3 className=\"font-semibold text-lg mb-2\">Key Observations</h3>\n                        <div className=\"prose prose-sm max-w-none text-muted-foreground rounded-md border p-4 bg-muted/50\">\n                            <ul className=\"list-disc pl-5\">\n                            {analysis.observations.split('\\n').map((obs, i) => obs.trim() && <li key={i}>{obs.replace(/^- /, '')}</li>)}\n                            </ul>\n                        </div>\n                    </div>\n\n                    <Card>\n                        <CardHeader>\n                            <CardTitle>AI Confidence Visualization (Simulated)</CardTitle>\n                            <CardDescription>This is a generated heatmap showing which parts of the image the AI may have focused on.</CardDescription>\n                        </CardHeader>\n                        <CardContent className=\"flex items-center justify-center bg-black rounded-md aspect-video p-2\">\n                            {analysis.heatmapDataUri ? (\n                                <Image src={analysis.heatmapDataUri} alt=\"AI Heatmap Visualization\" width={512} height={512} className=\"rounded-md object-contain aspect-square mx-auto\" />\n                            ) : (\n                                <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\n                                    <Loader2 className=\"h-8 w-8 animate-spin\" />\n                                    <p>Generating visualization...</p>\n                                </div>\n                            )}\n                        </CardContent>\n                    </Card>\n\n                    <Alert variant=\"destructive\">\n                        <AlertTriangle className=\"h-4 w-4\" />\n                        <AlertTitle>Disclaimer</AlertTitle>\n                        <AlertDescription>{analysis.disclaimer}</AlertDescription>\n                    </Alert>\n                </>\n            )}\n          </CardContent>\n           <CardFooter>\n                <Button onClick={handleDownloadReport} disabled={!analysis}>\n                    <Download className=\"mr-2 h-4 w-4\" />\n                    Download Report (PDF)\n                </Button>\n            </CardFooter>\n        </Card>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAlBA;;;;;;;;;;;;;;;;;;AAoBe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiC;IACxE,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD;IAEzB,MAAM,SAAS,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QAC1B,MAAM,OAAO,aAAa,CAAC,EAAE;QAC7B,IAAI,MAAM;YACR,MAAM,SAAS,IAAI;YACnB,OAAO,MAAM,GAAG,CAAC;gBACf,SAAS,EAAE,MAAM,EAAE;gBACnB,YAAY;gBACZ,SAAS;YACX;YACA,OAAO,aAAa,CAAC;QACvB;IACF,GAAG,EAAE;IAEL,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,YAAY,EAAE,GAAG,CAAA,GAAA,wKAAA,CAAA,cAAW,AAAD,EAAE;QAChE;QACA,QAAQ;YAAE,cAAc,EAAE;YAAE,aAAa,EAAE;YAAE,eAAe,EAAE;QAAC;QAC/D,UAAU;IACZ;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,OAAO;QACZ,aAAa;QACb,SAAS;QACT,YAAY;QAEZ,IAAI;YACF,MAAM,SAAS,MAAM,CAAA,GAAA,0JAAA,CAAA,gBAAa,AAAD,EAAE;gBAAE;YAAM;YAC3C,YAAY;QACd,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;YACd,SAAS;QACX,SAAU;YACR,aAAa;QACf;IACF;IAEC,MAAM,uBAAuB;QACxB,MAAM,gBAAgB,SAAS,cAAc,CAAC;QAC9C,IAAI,CAAC,iBAAiB,CAAC,UAAU;YAC7B,MAAM;gBACF,OAAO;gBACP,aAAa;gBACb,SAAS;YACb;YACA;QACJ;QAEA,MAAM;YACF,OAAO;YACP,aAAa;QACjB;QAEA,CAAA,GAAA,yJAAA,CAAA,UAAW,AAAD,EAAE,eAAe;YAAE,OAAO;QAAE,GAAG,IAAI,CAAC,CAAC;YAC3C,MAAM,UAAU,OAAO,SAAS,CAAC;YACjC,MAAM,MAAM,IAAI,mJAAA,CAAA,UAAK,CAAC,KAAK,MAAM;YACjC,MAAM,WAAW,IAAI,QAAQ,CAAC,QAAQ,CAAC,QAAQ;YAC/C,MAAM,YAAY,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS;YACjD,MAAM,cAAc,OAAO,KAAK;YAChC,MAAM,eAAe,OAAO,MAAM;YAClC,MAAM,QAAQ,cAAc;YAC5B,MAAM,QAAQ;YACd,MAAM,SAAS,QAAQ;YAEvB,IAAI,WAAW;YACf,IAAI,SAAS,WAAW;gBACpB,WAAW,CAAC,YAAY,MAAM,IAAI;YACtC;YAEA,IAAI,QAAQ,CAAC,SAAS,OAAO,GAAG,UAAU,OAAO;YACjD,IAAI,IAAI,CAAC,CAAC,0BAA0B,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC;QACtF;IACJ;IAEF,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;;kCACC,8OAAC;wBAAG,WAAU;;0CACZ,8OAAC,kNAAA,CAAA,aAAU;;;;;4BAAG;;;;;;;kCAEhB,8OAAC;wBAAE,WAAU;kCAAwB;;;;;;;;;;;;0BAKvC,8OAAC,iIAAA,CAAA,QAAK;gBAAC,SAAQ;;kCACb,8OAAC,wNAAA,CAAA,gBAAa;wBAAC,WAAU;;;;;;kCACzB,8OAAC,iIAAA,CAAA,aAAU;kCAAC;;;;;;kCACZ,8OAAC,iIAAA,CAAA,mBAAgB;kCAAC;;;;;;;;;;;;0BAKpB,8OAAC,gIAAA,CAAA,OAAI;;kCACH,8OAAC,gIAAA,CAAA,aAAU;;0CACT,8OAAC,gIAAA,CAAA,YAAS;0CAAC;;;;;;0CACX,8OAAC,gIAAA,CAAA,kBAAe;0CAAC;;;;;;;;;;;;kCAEnB,8OAAC,gIAAA,CAAA,cAAW;wBAAC,WAAU;;4BACpB,CAAC,sBACA,8OAAC;gCACE,GAAG,cAAc;gCAClB,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,qHACA,eAAe,iCAAiC;;kDAGlD,8OAAC;wCAAO,GAAG,eAAe;;;;;;kDAC1B,8OAAC,oNAAA,CAAA,cAAW;wCAAC,WAAU;;;;;;kDACvB,8OAAC;wCAAE,WAAU;kDACV,eAAe,2BAA2B;;;;;;;;;;;qDAI/C,8OAAC;gCAAI,WAAU;;kDACX,8OAAC,6HAAA,CAAA,UAAK;wCAAC,KAAK;wCAAO,KAAI;wCAAwB,OAAO;wCAAK,QAAQ;wCAAK,WAAU;;;;;;kDAClF,8OAAC,kIAAA,CAAA,SAAM;wCAAC,SAAQ;wCAAc,MAAK;wCAAO,WAAU;wCAA8B,SAAS,IAAM,SAAS;kDACtG,cAAA,8OAAC,0MAAA,CAAA,SAAM;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAK5B,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,oIAAA,CAAA,WAAQ;wCAAC,IAAG;wCAAU,SAAS;wCAAc,iBAAiB,CAAC,UAAY,gBAAgB,CAAC,CAAC;;;;;;kDAC9F,8OAAC,iIAAA,CAAA,QAAK;wCAAC,SAAQ;wCAAU,WAAU;kDAAgC;;;;;;;;;;;;0CAKrE,8OAAC,kIAAA,CAAA,SAAM;gCAAC,SAAS;gCAAe,UAAU,aAAa,CAAC,SAAS,CAAC;;oCAC/D,2BAAa,8OAAC,iNAAA,CAAA,UAAO;wCAAC,WAAU;;;;;;oCAChC,YAAY,iBAAiB;;;;;;;;;;;;;;;;;;;YAKnC,uBACC,8OAAC,iIAAA,CAAA,QAAK;gBAAC,SAAQ;;kCACb,8OAAC,wNAAA,CAAA,gBAAa;wBAAC,WAAU;;;;;;kCACzB,8OAAC,iIAAA,CAAA,aAAU;kCAAC;;;;;;kCACZ,8OAAC,iIAAA,CAAA,mBAAgB;kCAAE;;;;;;;;;;;;YAItB,CAAC,aAAa,QAAQ,mBACrB,8OAAC,gIAAA,CAAA,OAAI;gBAAC,IAAG;;kCACP,8OAAC,gIAAA,CAAA,aAAU;;0CACT,8OAAC,gIAAA,CAAA,YAAS;0CAAC;;;;;;0CACX,8OAAC,gIAAA,CAAA,kBAAe;0CAAC;;;;;;;;;;;;kCAEnB,8OAAC,gIAAA,CAAA,cAAW;wBAAC,WAAU;kCACpB,CAAC,yBACE,8OAAC;4BAAI,WAAU;;8CACX,8OAAC,oIAAA,CAAA,WAAQ;oCAAC,WAAU;;;;;;8CACpB,8OAAC,oIAAA,CAAA,WAAQ;oCAAC,WAAU;;;;;;8CACpB,8OAAC,oIAAA,CAAA,WAAQ;oCAAC,WAAU;;;;;;8CACpB,8OAAC;oCAAI,WAAU;;sDACX,8OAAC,oIAAA,CAAA,WAAQ;4CAAC,WAAU;;;;;;sDACpB,8OAAC,oIAAA,CAAA,WAAQ;4CAAC,WAAU;;;;;;sDACpB,8OAAC,oIAAA,CAAA,WAAQ;4CAAC,WAAU;;;;;;;;;;;;;;;;;iDAI5B;;8CACI,8OAAC;;sDACG,8OAAC;4CAAG,WAAU;sDAA6B;;;;;;sDAC3C,8OAAC;4CAAE,WAAU;sDAAiC,SAAS,OAAO;;;;;;;;;;;;8CAGlE,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAG,WAAU;sDAAwB;;;;;;wCACrC,SAAS,mBAAmB,CAAC,MAAM,GAAG,IAAI,SAAS,mBAAmB,CAAC,GAAG,CAAC,CAAC,MAAM,sBAC/E,8OAAC;gDAAgB,WAAU;;kEACvB,8OAAC;wDAAI,WAAU;;0EACX,8OAAC;gEAAE,WAAU;0EAAe,KAAK,SAAS;;;;;;0EAC1C,8OAAC;gEAAK,WAAU;;oEAA0B,KAAK,UAAU;oEAAC;;;;;;;;;;;;;kEAE9D,8OAAC,oIAAA,CAAA,WAAQ;wDAAC,OAAO,KAAK,UAAU;wDAAE,WAAU;;;;;;;+CALtC;;;;sEAOT,8OAAC;4CAAE,WAAU;sDAAgC;;;;;;;;;;;;8CAGtD,8OAAC;;sDACG,8OAAC;4CAAG,WAAU;sDAA6B;;;;;;sDAC3C,8OAAC;4CAAI,WAAU;sDACX,cAAA,8OAAC;gDAAG,WAAU;0DACb,SAAS,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,IAAM,IAAI,IAAI,oBAAM,8OAAC;kEAAY,IAAI,OAAO,CAAC,OAAO;uDAAvB;;;;;;;;;;;;;;;;;;;;;8CAKlF,8OAAC,gIAAA,CAAA,OAAI;;sDACD,8OAAC,gIAAA,CAAA,aAAU;;8DACP,8OAAC,gIAAA,CAAA,YAAS;8DAAC;;;;;;8DACX,8OAAC,gIAAA,CAAA,kBAAe;8DAAC;;;;;;;;;;;;sDAErB,8OAAC,gIAAA,CAAA,cAAW;4CAAC,WAAU;sDAClB,SAAS,cAAc,iBACpB,8OAAC,6HAAA,CAAA,UAAK;gDAAC,KAAK,SAAS,cAAc;gDAAE,KAAI;gDAA2B,OAAO;gDAAK,QAAQ;gDAAK,WAAU;;;;;qEAEvG,8OAAC;gDAAI,WAAU;;kEACX,8OAAC,iNAAA,CAAA,UAAO;wDAAC,WAAU;;;;;;kEACnB,8OAAC;kEAAE;;;;;;;;;;;;;;;;;;;;;;;8CAMnB,8OAAC,iIAAA,CAAA,QAAK;oCAAC,SAAQ;;sDACX,8OAAC,wNAAA,CAAA,gBAAa;4CAAC,WAAU;;;;;;sDACzB,8OAAC,iIAAA,CAAA,aAAU;sDAAC;;;;;;sDACZ,8OAAC,iIAAA,CAAA,mBAAgB;sDAAE,SAAS,UAAU;;;;;;;;;;;;;;;;;;;kCAKnD,8OAAC,gIAAA,CAAA,aAAU;kCACN,cAAA,8OAAC,kIAAA,CAAA,SAAM;4BAAC,SAAS;4BAAsB,UAAU,CAAC;;8CAC9C,8OAAC,0MAAA,CAAA,WAAQ;oCAAC,WAAU;;;;;;gCAAiB;;;;;;;;;;;;;;;;;;;;;;;;AAQzD","debugId":null}}]
}